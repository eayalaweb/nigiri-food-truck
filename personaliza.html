<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>Personaliza tu bandeja</title>
     <!-- <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-LN+7fdVzj6u52u30Kp6M/trliBMCMKTyK833zpbD+pXdCLuTusPj697FH4R/5mcr" crossorigin="anonymous"> -->
    <link rel="stylesheet" href="css/estilos.css">

   <link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Anton&family=DM+Sans:ital,opsz,wght@0,9..40,100..1000;1,9..40,100..1000&display=swap" rel="stylesheet">
    
</head>
  <body class="bg-color-tema">

  <!-------------NAVBAR----------------->
<nav class="navbar fixed-top navbar-expand-lg bg-color-tema" data-bs-theme="bg-dark">
      <div class="container">
        <a class="navbar-brand" href="index.html"><img src="img/logoo.svg" width="50%"></a>

            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
              <span class="navbar-toggler-icon"></span>
            </button>

        <div class="collapse navbar-collapse" id="navbarSupportedContent">
          <ul class="navbar-nav ms-auto mb-2 mb-lg-0"> <!----mx-auto va al medio / me va a la izk / ms al final--->
                <li class="nav-item me-3">
                  <a class="nav-link active" href="#">SOBRE NOSOTROS</a>
                </li>
                <li class="nav-item me-3">
                  <a class="nav-link active" href="personaliza.html" aria-current="page">PERSONALIZAR</a>
                </li>
                <li class="nav-item me-3">
                  <a class="nav-link" href="encuentranos.html">ENCUENTRANOS</a>
                </li>
                <li class="nav-item me-3">
                  <a class="nav-link" href="contacto.html">CONTACTO</a>
                </li>

                <li class="nav-item">
                  <a class="nav-link btn-body bg-naranja" href="pedido.html">CARTA</a>
                </li>
            
          </ul>

        </div>
      </div>
</nav>

<!-------------HERO----------------->
    <section class="container-w90 pt-nav">
        <div class="row">
            <div class="col-md-7">
                <h1 class="encabezado-h1">PERSONALIZA AQUÍ TU BANDEJA DE SUSHI</h1>
                <!-- <p>Puede cambiar cualquiera de nuestros sushi en los combos por otros tipos en nuestra selección. 
Por ejemplo 2 nigiri por el mismo número de nigiri en la lista, igualmente con hoso maki, uramaki, y futomaki.</p> -->
            </div>

            <div class="col-md-5">
                <button type="button" class="btn-mio bg-miverde">+36  65 84 78 35</button> <br><br>
                <button type="button" class="btn-mio bg-micolor">info @nigirifoodtruck.com</button>

            </div>

        </div>

    </section>

<!-------------GALERIA----------------->
  <section class="container-fluid pb-5 ">
     <div class="row g-0">
        <div class="col-4 col-lg-2 gallery-item">
          <img src="img/1-sushi.png" alt="Imagen 1" class="gallery-img">
        </div>
        <div class="col-4 col-lg-2 gallery-item">
          <img src="img/2-sushi.png" alt="Imagen 2" class="gallery-img">
        </div>
        <div class="col-4 col-lg-2 gallery-item">
          <img src="img/3-sushi.png" alt="Imagen 3" class="gallery-img">
        </div>
        <div class="col-4 col-lg-2 gallery-item">
          <img src="img/4-sushi.png" alt="Imagen 4" class="gallery-img">
        </div>
        <div class="col-4 col-lg-2 gallery-item">
          <img src="img/5-sushi.png" alt="Imagen 5" class="gallery-img">
        </div>
        <div class="col-4 col-lg-2 gallery-item">
          <img src="img/6-sushi.png" alt="Imagen 6" class="gallery-img">
        </div>

     </div>

  </section>

<!-------------CONTAINER----------------->
   <section class="micontainer bg-naranja ">
        <div class="row">
                
                
            <div class="col-md-7">
                <h3 class="encabezado-h3 text-white">INGREDIENTES FRESCOS Y RECETAS TRADICIONALES</h3>
                <p class="text-white">Nos movemos por la ciudad para llevarte los mejores rolls, nigiris y platos japoneses, sin complicaciones.Consulta nuestra ubicación del día en nuestra web o Instagram.</p>
                <a href="contacto.html">
              <button type="button" class="btn-body mb-3">CONTACTA CON NOSOTROS</button>
            </a>

            </div>

            <div class="col-md-5">
                <img src="img/img-personaliza.png" width="100%" alt=""></div>

            

        </div>

</section>


<!-------------ESCOGER SUSHIS----------------->
<section class="container py-5 p-5">
        <div class="row mb-5">
          <!-- NIGIRI -->
          <div class="col-md-4">
            <h2 class="category-title">Nigiri Sushi - 2 Piezas</h2>
            <div class="form-check">
              <input class="form-check-input item producto" type="checkbox" 
              value="4" id="nigiri1" data-nombre="Salmon Nigiri" data-precio="4€" data-id="producto01">
              <label class="form-check-label" for="nigiri1">Salmon Nigiri — 4€</label>
            </div>
            <div class="form-check">
              <input class="form-check-input item producto" type="checkbox" value="5" id="nigiri2" data-nombre="Atún Spicy" data-precio="5€" data-id="producto02">
              <label class="form-check-label" for="nigiri2">Atún Spicy — 5€</label>
            </div>
            <div class="form-check">
              <input class="form-check-input item producto" type="checkbox" value="5" id="nigiri3" data-nombre="Salmon con cebollin" data-precio="5€" data-id="producto03">
              <label class="form-check-label" for="nigiri3">Salmon con cebollin — 5€</label>
            </div>
            <div class="form-check">
              <input class="form-check-input item producto" type="checkbox" value="3" id="nigiri4" data-nombre="Salmon con Queso" data-precio="3€" data-id="producto04">
              <label class="form-check-label" for="nigiri4">Salmon con Queso — 3€</label>
            </div>
          </div>

          <!-- URAMAKI -->
          <div class="col-md-4">
            <h2 class="category-title">Uramaki - 4 Piezas</h2>
            <div class="form-check">
              <input class="form-check-input item producto" type="checkbox" value="6" id="uramaki1" data-nombre="Roll Picante" data-precio="6€" data-id="producto05"> 
              <label class="form-check-label" for="uramaki1">Roll Picante — 6€</label>
            </div>
            <div class="form-check">
              <input class="form-check-input item producto" type="checkbox" value="5" id="uramaki2"  data-nombre="Roll Especial" data-precio="5€" data-id="producto06">
              <label class="form-check-label" for="uramaki2">Roll Especial con Atún — 5€</label>
            </div>
            <div class="form-check">
              <input class="form-check-input item producto" type="checkbox" value="4" id="uramaki3"  data-nombre="Roll rebozado" data-precio="4€" data-id="producto07">
              <label class="form-check-label" for="uramaki3">Roll rebozado — 4€</label>
            </div>
            <div class="form-check">
              <input class="form-check-input item producto" type="checkbox" value="6" id="uramaki4"  data-nombre="Roll Clásico California" data-precio="6€" data-id="producto08">
              <label class="form-check-label" for="uramaki4">Roll Clásico California — 6€</label>
            </div>
          </div>

          <!-- MAKIS CLÁSICOS -->
          <div class="col-md-4">
            <h2 class="category-title">Makis Clásicos - 6 Piezas</h2>
            <div class="form-check">
              <input class="form-check-input item producto" type="checkbox" value="4" id="makis1" data-nombre="Nigiri Picante" data-precio="4€" data-id="producto09">
              <label class="form-check-label" for="makis1">Nigiri Picante — 4€</label>
            </div>
            <div class="form-check">
              <input class="form-check-input item producto" type="checkbox" value="3" id="makis2" data-nombre="Rainbow Roll" data-precio="3€" data-id="producto10">
              <label class="form-check-label" for="makis2">Rainbow Roll — 3€</label>
            </div>
            <div class="form-check">
              <input class="form-check-input item producto" type="checkbox" value="5" id="makis3" data-nombre="California Tempura" data-precio="5€" data-id="producto11">
              <label class="form-check-label" for="makis3">California Tempura — 5€</label>
            </div>
            <div class="form-check">
              <input class="form-check-input item producto" type="checkbox" value="6" id="makis4" data-nombre="California Roll" data-precio="6€" data-id="producto12">
              <label class="form-check-label" for="makis4">California Roll — 6€</label>
            </div>
          </div>
        </div>

</section>

<!-- SECCIÓN RESUMEN -->
<section class="container-fluid bg-miverde pt-5 pb-5">
  <article class="resumen">
    <div class="align-items-center justify-content-center bg-color-tema p-5 m-auto ">
      <h3 class="text-center encabezado-h3">TU PEDIDO ESTÁ LISTO</h3>
      <table id="tablaPedidos" >
        <thead class="titulo-tabla">
          <tr>
            <th>Nº</th>
            <th>Producto</th>
            <th>Precio/u</th>
            <th>Cantidad</th>
            <th>Total</th>
          </tr>
        </thead>
        <tbody id="tableItems" class="tabla-body"></tbody>
      </table>

      <div id="totalCompra" class="text-center text-total">
        <span>TOTAL: </span>
        <span id="total" data-total="0">0€</span>
      </div>

      <div class="boton m-auto" id="botonPagar">HACER EL PEDIDO</div>
    </div>
  </article>
</section>

<!-- ************************************************************ -->
<!-- CONFIRMA TU PEDIDO - MODAL-->
<section class="container g-0">

    <div id="modal">
        <article class="resume" id="contenedorModal">
                  <img src="img/close.svg" width="30px" alt="cerrar" id="cerrar">
                  <h3 class="encabezado-h3">CONFIRMA TU PEDIDO</h3>
                  <!-- aqui ira la tabla clonada de forma dinamica desde JS-->

                  <div>
                      <!-- <span>TOTAL:</span> -->
                      <span id="totalmodal" data-total="0"></span>
                  </div>

            <!-- <div class="boton" id="botonConfirmar">HACER EL PEDIDO</div> -->

              <form>
                    <div class="row mb-3">
                    <div class="col-md-6">
                    <label for="nombre" class="form-label">Nombre y Apellido</label>
                    <input type="text" class="form-control" id="nombre" placeholder="Ingresa tu nombre y apellido">
                    </div>
                    <div class="col-md-6">
                    <label for="telefono" class="form-label">Teléfono</label>
                    <input type="tel" class="form-control" id="telefono" placeholder="Número de teléfono">
                    </div>
                    </div>
                    
                    <div class="mb-3">
                    <label for="email" class="form-label">Correo electrónico</label>
                    <input type="email" class="form-control" id="email" placeholder="ejemplo@correo.com">
                    </div>
                    <div class="mb-3">
                    <label for="direccion" class="form-label">Dirección</label>
                    <input type="text" class="form-control" id="direccion" placeholder="Calle, número, ciudad">
                    </div>
                    <div class="mb-3">
                    <label for="coment"  class="form-label">Comentarios</label>
                    <textarea name="coment" id="coment" class="form-control"></textarea>
                    </div>
                    <button type="submit" class="btn btn-primary">Enviar</button>
                </form>
                  
        </article>
    </div>
                        
    



</section>
<!-- TODO; mejorar el modal -->






    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/js/bootstrap.bundle.min.js" integrity="sha384-ndDqU0Gzau9qJ1lfW4pNLlhNTkCfHzAVBReH9diLvGRem5+R9g2FzA8ZGN954O5Q" crossorigin="anonymous"></script>
    <!-- SCRIPT PARA EL CHECKBOX -->
    <script>
   
   // JS UNA VEZ SE CARGE EN EL DOM

// recoger el html en constantes
// recoger todos los imputs a traves de la clase productos
const productos = document.getElementsByClassName("producto")
const tableItems = document.getElementById("tableItems")
const total = document.getElementById("total") //Span donde totalizo la compra


// Contar filas de cada TD
function contarFilas(){
        // Recojo todas las filas sólo cuando llamo a esta función
        const filas = document.querySelectorAll(".fila")
        let contador = 0

        //Hago una iteración mediante foreach
        filas.forEach(fila => {

            const tds = fila.querySelectorAll('td')
            let primerTd = tds[0]

            console.log(primerTd)
            if(primerTd){
                contador = contador + 1
                console.log(contador)
                primerTd.innerText=contador
            }
        }); 
    }

// recorrer en un FOR OF todos los product, en cada interación trabajare con cada uno 
for(const producto of productos){
    producto.addEventListener("change", function(){
        //   console.log(producto)

        // Recojo en constantes los datos de ese INPUT que a sufrido el evento CHANGE (nombre, id y precio)
        const id = producto.getAttribute("data-id")
        const nombre = producto.getAttribute("data-nombre")


        let precio = producto.getAttribute("data-precio") // es una variable para operar con ella
        let cantidad = "1"  //  luego vendria dinamico
        let totalLinea = 0 //  LA usaremos para multiplicar cantidad por precio unitario
        let totalCompraNuevo = 0 // Aqui calcularemos el nuevo total 
        

        let totalCompra = total.getAttribute("data-total") //  aqui tendremos el total como texto y en una data
        totalCompra = parseFloat(totalCompra) // Paso el valor a un número decimal para poder operar

        // GESTIÓN DEL TOTAL POR LINEA
        precio = parseFloat(precio)
        cantidad = parseFloat(cantidad)
        totalLinea = precio * cantidad



        // Condición para actuar en función de si el input esta o no checked
        if(producto.checked){
            // Si ese input esta checked añado a la tabla un nuevo TR (fila) con los TD y los datos de ese producto
            // console.log("el input ${id} lo han checkeado")

            // crear elementos HTML desde JS, para luego meter atributos y valores despues inyectarlos en el HTML

             // EM: Solo hemos creado TR entonces en el tbody tenemos que CREAR los TD 
            const tr = document.createElement("tr")
            const td1 = document.createElement("td")
            const td2 = document.createElement("td")
            const td3 = document.createElement("td")
            const td4 = document.createElement("td")
            const td5 = document.createElement("td")

            // asigno valores
            // EM: Aqui a cada TD le asignamos un constante que hace el evento mediante la data
            tr.setAttribute("id", id)
             tr.setAttribute("class", "fila")
            td1.innerText = "#"
            td2.innerText = nombre
            td3.innerText = precio + "€"
            td4.innerText = cantidad
            td5.innerText = totalLinea + "€"
            // anidamiento appenChild
            tr.appendChild(td1)
            tr.appendChild(td2)
            tr.appendChild(td3)
            tr.appendChild(td4)
            tr.appendChild(td5)
            tableItems.appendChild(tr)

            // Gestión del total de la compra (sumar)
            totalCompraNuevo = totalCompra + totalLinea
            total.setAttribute("data-total", totalCompraNuevo)
            total.innerText = totalCompraNuevo + "€"

        }else{

            // Si ese input NO esta checked, busco el TR que tenga el mismo ID de este data-id del input y lo quito
            // console.log("El input ${id} lo han descheckeado")
            document.getElementById(id).remove()

            // Gestión del total de la compra (restar)
            totalCompraNuevo = totalCompra - totalLinea
            total.setAttribute("data-total", totalCompraNuevo)
            total.innerText = totalCompraNuevo + "€"
        }

         contarFilas() // Llamo a la función que cuenta las filas y actualiza el primer TD de cada fila

    })

}


// +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
// GESTION DE MODAL Y CLONACION DE TABLA
const botonPagar = document.getElementById("botonPagar")
const cerrar = document.getElementById("cerrar")
const modal = document.getElementById("modal")

const contenedorModal = document.getElementById("contenedorModal") 
const tablaPedidos = document.getElementById("tablaPedidos")
const totalCompra = document.getElementById("totalCompra")



// si se hace click sobre botonPedido, abro modal
botonPagar.addEventListener("click", function(){

    //Clono el html de la tabla con todos sus hijos(true)
    const tablaPedidosClonada = tablaPedidos.cloneNode(true)
    const totalCompraClonada = totalCompra.cloneNode(true)


    //Comprobamos si hay tabla y si la hay la quito

    const tablaAnterior = contenedorModal.querySelector('table')
    const totalCompraAnterior = contenedorModal.querySelector('#totalCompra')
    if(tablaAnterior){
        tablaAnterior.remove()
         totalCompraAnterior.remove()
     
    }
    contenedorModal.insertBefore(tablaPedidosClonada, contenedorModal.children[2])
    contenedorModal.insertBefore(totalCompraClonada, contenedorModal.children[3])


    modal.style.display = "flex"

})
     
// si hago click sobre el boton de id close, se cierra
cerrar.addEventListener("click", function(){
    modal.style.display = "none"

})


    </script>
  </body>

    <!-------------FOOTER----------------->
<footer class=" bg-micolor pt-5 p-5">
      <div class="row ">
          <div class="col-md-6 ">
                <h5 class="footer-h5 text-rojo ">SABORES JAPONESES SOBRE RUEDAS. SUSHI FRESCO TODOS LOS DÍAS.</h5>

          </div>
<!-- Contacto -->
          <div class="col-md-6">
            <div class="row">
                  <div class="col-6">
                      <h5 class="info-footer">CONTACTO</h5>
                      <div class="d-flex ">
                        <!-- <i class="fa-regular fa-truck"></i> -->
                        <img src="img/bus.svg" width="5%" alt="" class="me-3"> 
                        <p> Donostia - San Sebastián</p>

                      </div>

                      <div class="d-flex ">
                        <img src="img/call.svg" alt="" width="5%" alt="" class="me-3">
                        <p> +36  65 84 78 35</p>
                      </div>

                      <div class="d-flex ">
                        <img src="img/cloud-upload.svg" alt="" width="5%" alt="" class="me-3">
                        <p>info @nigirifoodtruck.com</p>
                      </div>

                  </div>


                  <div class="col-6">
                      <h5 class="info-footer">INFORMACIÓN</h5>
                      <a href="index.html" class="footer-link"> Inicio </a> <br> 
                      <a href="quienes-somos.html" class="footer-link"> Sobre nosotros </a> <br>
                      <a href="personaliza.html" class="footer-link"> Personalizar </a> <br>
                      <a href="encuentranos.html" class="footer-link"> Encontrar </a> <br>
                      <a href="contacto.html" class="footer-link"> Contacto </a> <br>
                      <a href="pedido.html" class="footer-link"> Pedidos </a> <br>


                  </div>
              </div>
          </div>
      </div>
    
</footer>
</html>